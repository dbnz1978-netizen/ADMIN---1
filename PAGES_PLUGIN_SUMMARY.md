# Плагин управления страницами (pages-plugin)

## Обзор
Создан новый плагин `pages-plugin` как полная копия плагина `news-plugin`, но адаптированный для управления страницами сайта вместо новостей.

## Что было сделано

### 1. Скопирован плагин
Создана полная копия директории `/plugins/news-plugin/` в `/plugins/pages-plugin/`

### 2. Обновлены конфигурационные файлы

**plugin.json:**
- Имя плагина: `pages-plugin`
- Отображаемое имя: "Система управления страницами"
- Описание обновлено для управления страницами

**nav-config.json:**
- Название меню: "Страницы"
- Иконка меню: `bi-file-earmark-text`
- Подменю:
  - Категории страниц
  - Добавить категорию
  - Список страниц
  - Добавить страницу
  - Настройки

### 3. Изменены таблицы базы данных

**Старые таблицы (news-plugin):**
- `news_categories` - категории новостей
- `news_articles` - статьи новостей
- `news_extra_content` - дополнительный контент новостей

**Новые таблицы (pages-plugin):**
- `pages_categories` - категории страниц
- `pages_content` - содержимое страниц
- `pages_extra_content` - дополнительный контент страниц

### 4. Обновлены все PHP файлы

**Изменения в переменных:**
- `$catalogTable`: `news_articles` → `pages_content`
- `$categoryTable`: `news_categories` → `pages_categories`
- `$categoryUrlPrefix`: `news` → `page`
- `$titlemeta`: "Новости" → "Страницы"

**Изменения в параметрах:**
- GET параметр: `news_id` → `page_id`
- Переменная: `$newsId` → `$pageId`

**Изменения в constraint'ах:**
- `fk_news_categories_*` → `fk_pages_categories_*`
- `fk_news_articles_*` → `fk_pages_content_*`
- `fk_news_extra_content_*` → `fk_pages_extra_content_*`

### 5. Обновлены файлы функций

**get_record_avatar.php:**
- Добавлена поддержка таблиц: `pages_categories`, `pages_content`, `pages_extra_content`

**category_path.php:**
- SQL запросы обновлены для работы с таблицей `pages_categories`

**plugin_helper.php:**
- Значение по умолчанию изменено на `pages-plugin`

**plugin_settings.php:**
- Комментарии обновлены для pages-plugin

### 6. Обновлен текст интерфейса

Все упоминания на русском языке изменены:
- "новости" → "страницы"
- "новость" → "страница"
- "новостей" → "страниц"

## Структура плагина

```
plugins/pages-plugin/
├── functions/                  # Вспомогательные функции
│   ├── category_path.php      # Построение пути категорий
│   ├── get_record_avatar.php  # Получение изображений
│   ├── pagination.php         # Пагинация
│   ├── plugin_helper.php      # Автоопределение имени плагина
│   └── plugin_settings.php    # Работа с настройками
├── js/                        # JavaScript файлы
│   └── authorsearch.js        # Поиск авторов
├── pages/                     # Страницы админ-панели
│   ├── articles/              # Управление страницами
│   │   ├── add_article.php   # Добавление/редактирование страницы
│   │   ├── add_extra.php     # Доп. контент
│   │   ├── article_list.php  # Список страниц
│   │   ├── extra_list.php    # Список доп. контента
│   │   ├── header.php        # Общий заголовок
│   │   └── js/
│   │       └── categorysearch.js
│   ├── categories/            # Управление категориями
│   │   ├── add_category.php  # Добавление/редактирование
│   │   └── category_list.php # Список категорий
│   └── settings/              # Настройки плагина
│       └── access.php         # Управление доступом
├── install.php                # Скрипт установки
├── uninstall.php              # Скрипт удаления
├── nav-config.json            # Конфигурация меню
└── plugin.json                # Основная конфигурация
```

## Гарантия изоляции

Плагины `news-plugin` и `pages-plugin` полностью изолированы:

✅ **Разные таблицы БД** - нет конфликтов в базе данных
✅ **Разные имена плагинов** - система различает их
✅ **Разные URL пути** - `/plugins/news-plugin/` vs `/plugins/pages-plugin/`
✅ **Разные пункты меню** - "Новости" vs "Страницы"
✅ **Независимая работа** - можно использовать оба одновременно

## Инструкция по установке

1. **Войдите в админ-панель** как администратор
2. **Перейдите в раздел плагинов** (меню "Плагины")
3. **Найдите "pages-plugin"** в списке доступных плагинов
4. **Нажмите "Установить"**
5. **Дождитесь создания таблиц** в базе данных
6. **Плагин готов к использованию!**

В меню админ-панели появится новый пункт "Страницы" с подменю.

## Функционал плагина

### Категории страниц
- Создание иерархии категорий (вложенность)
- SEO настройки (meta title, description)
- Изображения категорий
- Управление сортировкой
- Статус (активна/неактивна)

### Страницы
- Создание и редактирование страниц
- Привязка к категориям
- WYSIWYG редактор для контента
- Множественные изображения
- SEO оптимизация
- ЧПУ URL
- Счетчик просмотров
- Сортировка
- Статус публикации

### Дополнительный контент
- Блоки дополнительной информации для страниц
- Отдельные изображения и тексты
- Управление порядком отображения

### Управление доступом
- Настройка прав для пользователей с ролью "user"
- Ограничение количества изображений
- Логирование действий

## Различия с плагином новостей

| Параметр | News Plugin | Pages Plugin |
|----------|-------------|--------------|
| Название меню | Новости | Страницы |
| Иконка | bi-layout-wtf | bi-file-earmark-text |
| Таблица контента | news_articles | pages_content |
| Таблица категорий | news_categories | pages_categories |
| Доп. контент | news_extra_content | pages_extra_content |
| URL префикс | news | page |
| GET параметр | news_id | page_id |

## Проверка качества

✅ **Code Review** - пройден без замечаний
✅ **Security Scan** - уязвимостей не обнаружено
✅ **Изоляция** - конфликты с news-plugin исключены
✅ **Терминология** - все тексты обновлены
✅ **База данных** - схема полностью отдельная

## Поддержка и развитие

Плагин построен по той же архитектуре, что и news-plugin:
- Использует те же принципы безопасности
- Тот же подход к валидации данных
- Совместим с системой прав доступа
- Интегрирован с медиа-библиотекой
- Поддерживает глобальные настройки изображений

---

**Дата создания:** 2026-02-11  
**Версия:** 1.0.0  
**Автор:** Команда разработки
